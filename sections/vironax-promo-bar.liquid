{% comment %}
  VironaX Promo Bar - Enhanced Version
  Scrolling announcement bar with sticky position controls
  Universal padding/size/spacing controls
{% endcomment %}

<style>
  #shopify-section-{{ section.id }} {
    --promo-padding-top: {{ section.settings.padding_top }}px;
    --promo-padding-bottom: {{ section.settings.padding_bottom }}px;
    --promo-margin-top: {{ section.settings.margin_top }}px;
    --promo-margin-bottom: {{ section.settings.margin_bottom }}px;
    --promo-bg-opacity: {{ section.settings.background_opacity | divided_by: 100.0 }};
  }

  {% if section.settings.enable_sticky %}
    #shopify-section-{{ section.id }} {
      position: fixed;
      left: 0;
      right: 0;
      z-index: {{ section.settings.z_index | default: 1002 }};
      {% if section.settings.sticky_position == 'top' %}
        top: {{ section.settings.sticky_offset }}px;
      {% else %}
        bottom: {{ section.settings.sticky_offset }}px;
      {% endif %}
    }
  {% endif %}
</style>

<div
  class="vironax-promo-bar"
  data-sticky="{{ section.settings.enable_sticky }}"
  data-position="{{ section.settings.sticky_position }}"
  {% if section.settings.show_on == 'desktop_only' %}
    style="display: block;"
  {% elsif section.settings.show_on == 'mobile_only' %}
    style="display: block;"
  {% endif %}
>
  <div class="vironax-promo-bar__track" style="animation-duration: {{ section.settings.scroll_speed }}s;">
    {% for i in (1..3) %}
      <div class="vironax-promo-bar__content">
        {% if section.settings.message_1 != blank %}
          <span class="vironax-promo-bar__item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
            {{ section.settings.message_1 }}
          </span>
        {% endif %}
        {% if section.settings.message_2 != blank %}
          <span class="vironax-promo-bar__item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/>
            </svg>
            {{ section.settings.message_2 }}
          </span>
        {% endif %}
        {% if section.settings.message_3 != blank %}
          <span class="vironax-promo-bar__item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/>
            </svg>
            {{ section.settings.message_3 }}
          </span>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

<style>
  .vironax-promo-bar {
    background-color: rgba(var(--text-color), var(--promo-bg-opacity, 1));
    color: rgb(var(--background));
    overflow: hidden;
    padding-top: var(--promo-padding-top, var(--spacing-sm));
    padding-bottom: var(--promo-padding-bottom, var(--spacing-sm));
    margin-top: var(--promo-margin-top, 0);
    margin-bottom: var(--promo-margin-bottom, 0);
    position: relative;
  }

  .vironax-promo-bar__track {
    display: flex;
    animation: vironax-scroll 30s linear infinite;
    width: fit-content;
  }

  .vironax-promo-bar__content {
    display: flex;
    align-items: center;
    gap: var(--spacing-3xl);
    padding: 0 var(--spacing-lg);
    flex-shrink: 0;
  }

  .vironax-promo-bar__item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-family: var(--text-font-family);
    font-size: {{ section.settings.font_size }}px;
    font-weight: {{ section.settings.font_weight }};
    text-transform: {{ section.settings.text_transform }};
    letter-spacing: {{ section.settings.letter_spacing }}em;
    white-space: nowrap;
  }

  .vironax-promo-bar__item svg {
    flex-shrink: 0;
  }

  @keyframes vironax-scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-33.333%);
    }
  }

  .vironax-promo-bar:hover .vironax-promo-bar__track {
    animation-play-state: paused;
  }

  /* Desktop only */
  {% if section.settings.show_on == 'desktop_only' %}
  @media screen and (max-width: 699px) {
    #shopify-section-{{ section.id }} {
      display: none !important;
    }
  }
  {% endif %}

  /* Mobile only */
  {% if section.settings.show_on == 'mobile_only' %}
  @media screen and (min-width: 700px) {
    #shopify-section-{{ section.id }} {
      display: none !important;
    }
  }
  {% endif %}

  @media screen and (max-width: 699px) {
    .vironax-promo-bar__item {
      font-size: {{ section.settings.font_size_mobile | default: 11 }}px;
    }

    .vironax-promo-bar__content {
      gap: var(--spacing-xl);
      padding: 0 var(--spacing-md);
    }
  }

  /* Blur effect for sticky */
  {% if section.settings.enable_blur %}
  .vironax-promo-bar[data-sticky="true"] {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  {% endif %}
</style>

{% schema %}
{
  "name": "VironaX Promo Bar",
  "settings": [
    {
      "type": "header",
      "content": "Messages"
    },
    {
      "type": "text",
      "id": "message_1",
      "label": "Message 1",
      "default": "Free Shipping Over 250 SAR"
    },
    {
      "type": "text",
      "id": "message_2",
      "label": "Message 2",
      "default": "3-4 Day Delivery to Saudi & GCC"
    },
    {
      "type": "text",
      "id": "message_3",
      "label": "Message 3",
      "default": "Pay in 4 with Tamara & Tabby"
    },
    {
      "type": "header",
      "content": "Sticky Position Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky",
      "label": "Enable sticky promo bar",
      "info": "Makes the bar fixed to top or bottom when scrolling",
      "default": false
    },
    {
      "type": "select",
      "id": "sticky_position",
      "label": "Sticky position",
      "options": [
        { "value": "top", "label": "Top of page" },
        { "value": "bottom", "label": "Bottom of page" }
      ],
      "default": "top"
    },
    {
      "type": "range",
      "id": "sticky_offset",
      "label": "Offset from top/bottom",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "z_index",
      "label": "Z-index (stacking order)",
      "min": 900,
      "max": 1000,
      "step": 1,
      "default": 999,
      "info": "Higher values appear above other elements"
    },
    {
      "type": "select",
      "id": "show_on",
      "label": "Show on",
      "options": [
        { "value": "all", "label": "Desktop and Mobile" },
        { "value": "desktop_only", "label": "Desktop only" },
        { "value": "mobile_only", "label": "Mobile only" }
      ],
      "default": "all"
    },
    {
      "type": "range",
      "id": "background_opacity",
      "label": "Background opacity (%)",
      "min": 50,
      "max": 100,
      "step": 5,
      "default": 100
    },
    {
      "type": "checkbox",
      "id": "enable_blur",
      "label": "Enable blur effect when sticky",
      "default": false
    },
    {
      "type": "header",
      "content": "Animation Settings"
    },
    {
      "type": "range",
      "id": "scroll_speed",
      "label": "Scroll speed (seconds)",
      "info": "Lower = faster",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 30
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "font_size",
      "label": "Font size (desktop)",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "font_size_mobile",
      "label": "Font size (mobile)",
      "min": 9,
      "max": 14,
      "step": 1,
      "unit": "px",
      "default": 11
    },
    {
      "type": "select",
      "id": "font_weight",
      "label": "Font weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi-bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "500"
    },
    {
      "type": "select",
      "id": "text_transform",
      "label": "Text transform",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "uppercase", "label": "Uppercase" },
        { "value": "capitalize", "label": "Capitalize" }
      ],
      "default": "uppercase"
    },
    {
      "type": "range",
      "id": "letter_spacing",
      "label": "Letter spacing (em)",
      "min": 0,
      "max": 0.2,
      "step": 0.1,
      "default": 0.1
    },
    {
      "type": "header",
      "content": "Padding Settings"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 10
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 10
    },
    {
      "type": "header",
      "content": "Spacing Settings"
    },
    {
      "type": "range",
      "id": "margin_top",
      "label": "Margin top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "label": "Margin bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "VironaX Promo Bar"
    }
  ]
}
{% endschema %}
